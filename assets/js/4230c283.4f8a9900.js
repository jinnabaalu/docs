"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9592],{5845:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>c,toc:()=>l});const c=JSON.parse('{"id":"elasticsearch/EnableXPackInElasticsearchContainer","title":"\ud83d\udc33 Enable XPack in Elasticsearch Container","description":"Secure Elasticsearch with X-Pack and SSL \u2014 production-ready single-node setup","source":"@site/docs/elasticsearch/EnableXPackInElasticsearchContainer.md","sourceDirName":"elasticsearch","slug":"/ElasticStack/EnableXPackInElasticsearchContainer","permalink":"/oio/docs/ElasticStack/EnableXPackInElasticsearchContainer","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/elasticsearch/EnableXPackInElasticsearchContainer.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"\ud83d\udc33 Enable XPack in Elasticsearch Container","description":"Secure Elasticsearch with X-Pack and SSL \u2014 production-ready single-node setup","slug":"/ElasticStack/EnableXPackInElasticsearchContainer"},"sidebar":"tutorialSidebar","previous":{"title":"\ud83d\udc33 Basic Logstash Pipeline","permalink":"/oio/docs/ElasticStack/BasicLogstashPipeline"},"next":{"title":"\ud83d\udc33 Enable XPack in Kibana Container","permalink":"/oio/docs/ElasticStack/EnableXPackInKibanaContainer"}}');var t=r(4848),n=r(8453);const a={sidebar_position:6,title:"\ud83d\udc33 Enable XPack in Elasticsearch Container",description:"Secure Elasticsearch with X-Pack and SSL \u2014 production-ready single-node setup",slug:"/ElasticStack/EnableXPackInElasticsearchContainer"},i="\ud83d\udc33 Enable XPack in Elasticsearch Container",o={},l=[{value:"\ud83d\udee0\ufe0f Generate X-Pack Compatible Certificates",id:"\ufe0f-generate-x-pack-compatible-certificates",level:2},{value:"\u2699\ufe0f How to Use the Certs in Your Elasticsearch Container",id:"\ufe0f-how-to-use-the-certs-in-your-elasticsearch-container",level:2},{value:"\ud83d\udc33 Example: Docker Compose with SSL-Enabled Elasticsearch",id:"-example-docker-compose-with-ssl-enabled-elasticsearch",level:2},{value:"\u2705 The volumes line ensures Elasticsearch can find your certs inside /usr/share/elasticsearch/config/certs.",id:"-the-volumes-line-ensures-elasticsearch-can-find-your-certs-inside-usrshareelasticsearchconfigcerts",level:2},{value:"\ud83d\udce6 Download Ready-to-Use Docker Compose",id:"-download-ready-to-use-docker-compose",level:2},{value:"\ud83d\udea8 Common Errors and Pitfalls",id:"-common-errors-and-pitfalls",level:2},{value:"<strong>Volume path mistakes</strong> \u2192 Elasticsearch won&#39;t find certs and crash early.",id:"volume-path-mistakes--elasticsearch-wont-find-certs-and-crash-early",level:2},{value:"\ud83c\udfaf Pro Tip:",id:"-pro-tip",level:2}];function h(e){const s={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"-enable-xpack-in-elasticsearch-container",children:"\ud83d\udc33 Enable XPack in Elasticsearch Container"})}),"\n",(0,t.jsxs)(s.p,{children:["Lock it down. \ud83d\udd12",(0,t.jsx)(s.br,{}),"\n","Let's enable ",(0,t.jsx)(s.strong,{children:"X-Pack"})," and set up ",(0,t.jsx)(s.strong,{children:"SSL"})," on a containerized Elasticsearch node, properly."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"\ufe0f-generate-x-pack-compatible-certificates",children:"\ud83d\udee0\ufe0f Generate X-Pack Compatible Certificates"}),"\n",(0,t.jsxs)(s.p,{children:["You\u2019ve got 3 easy ways to generate SSL certs. All require ",(0,t.jsx)(s.strong,{children:"Docker"})," to be running:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Bash Script"}),":",(0,t.jsx)(s.br,{}),"\n","\ud83d\udc49 ",(0,t.jsx)(s.a,{href:"http://jinnabalu.com/oio/docs/ElasticStack/EnableXPackSecurityCertsGenerator",children:"Generate certs with Bash (interactive prompts)"})]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Docker Run"}),":",(0,t.jsx)(s.br,{}),"\n","\ud83d\udc49 ",(0,t.jsxs)(s.a,{href:"/oio/docs/ElasticStack/EnableXPackSecurityCertsGeneratorWithDockerRun",children:["Generate certs using ",(0,t.jsx)(s.code,{children:"docker run"})]})]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Docker Compose"}),":",(0,t.jsx)(s.br,{}),"\n","\ud83d\udc49 ",(0,t.jsxs)(s.a,{href:"/oio/docs/ElasticStack/EnableXPackSecurityCertsGeneratorWithDockerCompose",children:["Generate certs using ",(0,t.jsx)(s.code,{children:"docker compose"})]})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["Pick ",(0,t.jsx)(s.strong,{children:"any"})," method you vibe with.",(0,t.jsx)(s.br,{}),"\n","Once generated, ",(0,t.jsx)(s.strong,{children:"copy the certs"})," to your target environment or server."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"\ufe0f-how-to-use-the-certs-in-your-elasticsearch-container",children:"\u2699\ufe0f How to Use the Certs in Your Elasticsearch Container"}),"\n",(0,t.jsx)(s.p,{children:"Add these properties to your Elasticsearch config:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"xpack.security.enabled=true\nxpack.security.http.ssl.enabled=true\n\nxpack.security.http.ssl.key=certs/es01/es01.key\nxpack.security.http.ssl.certificate=certs/es01/es01.crt\nxpack.security.http.ssl.certificate_authorities=certs/ca/ca.crt\n\nxpack.security.transport.ssl.enabled=true\nxpack.security.transport.ssl.key=certs/es01/es01.key\nxpack.security.transport.ssl.certificate=certs/es01/es01.crt\nxpack.security.transport.ssl.certificate_authorities=certs/ca/ca.crt\nxpack.security.transport.ssl.verification_mode=certificate\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-example-docker-compose-with-ssl-enabled-elasticsearch",children:"\ud83d\udc33 Example: Docker Compose with SSL-Enabled Elasticsearch"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yml",children:'services:\n  es01:\n    image: docker.elastic.co/elasticsearch/elasticsearch:9.0.0\n    container_name: es01\n    environment:\n      - discovery.type=single-node\n      - xpack.security.enabled=true\n      - xpack.security.http.ssl.enabled=true\n      - xpack.security.http.ssl.key=certs/es01/es01.key\n      - xpack.security.http.ssl.certificate=certs/es01/es01.crt\n      - xpack.security.http.ssl.certificate_authorities=certs/ca/ca.crt\n      - xpack.security.transport.ssl.enabled=true\n      - xpack.security.transport.ssl.key=certs/es01/es01.key\n      - xpack.security.transport.ssl.certificate=certs/es01/es01.crt\n      - xpack.security.transport.ssl.certificate_authorities=certs/ca/ca.crt\n      - xpack.security.transport.ssl.verification_mode=certificate\n    volumes:\n      - ./certs:/usr/share/elasticsearch/config/certs\n    ports:\n      - "9200:9200"\n      - "9300:9300"\n'})}),"\n",(0,t.jsx)(s.h2,{id:"-the-volumes-line-ensures-elasticsearch-can-find-your-certs-inside-usrshareelasticsearchconfigcerts",children:"\u2705 The volumes line ensures Elasticsearch can find your certs inside /usr/share/elasticsearch/config/certs."}),"\n",(0,t.jsx)(s.h2,{id:"-download-ready-to-use-docker-compose",children:"\ud83d\udce6 Download Ready-to-Use Docker Compose"}),"\n",(0,t.jsx)(s.p,{children:"You can grab a ready-to-go compose file here \ud83d\udc47:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"wget -O docker-compose.yml https://raw.githubusercontent.com/jinnabaalu/ELKOperations/refs/heads/main/elasticsearch/single-node/xpack-docker-compose.yml\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Create a ",(0,t.jsx)(s.code,{children:".env"})," file with the following"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"STACK_VERSION=9.0.0\nCLUSTER_NAME=es-cluster\nELASTIC_PASSWORD=changeme\nES_PORT=9200\nMEM_LIMIT=2g\n"})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"\u26a1 Note: Make sure to place your generated certs in the same folder where you run this compose file, so that volume mount works."}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-common-errors-and-pitfalls",children:"\ud83d\udea8 Common Errors and Pitfalls"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Mismatch in CN/SAN"})," \u2192 SSL errors. Ensure the certs are issued for the correct hostname (like es01)."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Wrong file paths"})," \u2192 SSL handshake failures (PKIX path building failed)."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Missing verification mode"})," \u2192 Transport layer fails. Always set:\n",(0,t.jsx)(s.code,{children:"xpack.security.transport.ssl.verification_mode=certificate"})]}),"\n",(0,t.jsxs)(s.h2,{id:"volume-path-mistakes--elasticsearch-wont-find-certs-and-crash-early",children:[(0,t.jsx)(s.strong,{children:"Volume path mistakes"})," \u2192 Elasticsearch won't find certs and crash early."]}),"\n",(0,t.jsx)(s.h2,{id:"-pro-tip",children:"\ud83c\udfaf Pro Tip:"}),"\n",(0,t.jsx)(s.p,{children:"Want to test your SSL-secured Elasticsearch is up?"}),"\n",(0,t.jsx)(s.p,{children:"After starting your container:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"curl -k --cert ./certs/es01/es01.crt -u elastic:${ELASTIC_PASSWORD} --key ./certs/es01/es01.key https://localhost:9200\n"})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"-k"})," = ignore self-signed cert warning if needed."]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"If you get a JSON response, congrats, your SSL setup is \ud83d\udd25."})]})}function d(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,s,r)=>{r.d(s,{R:()=>a,x:()=>i});var c=r(6540);const t={},n=c.createContext(t);function a(e){const s=c.useContext(n);return c.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),c.createElement(n.Provider,{value:s},e.children)}}}]);