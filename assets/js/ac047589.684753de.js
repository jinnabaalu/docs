"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[134],{729:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"mongo/CreateKeyFile","title":"\ud83d\udd10 Security Create Keyfile for MongoDB Security","description":"Quick and clear guide to generate a secure MongoDB keyfile for containerized environments on Mac and Linux. Lock it down right.","source":"@site/docs/mongo/CreateKeyFile.md","sourceDirName":"mongo","slug":"/CreateMongoSecurityKey","permalink":"/oio/docs/CreateMongoSecurityKey","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/mongo/CreateKeyFile.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"\ud83d\udd10 Security Create Keyfile for MongoDB Security","description":"Quick and clear guide to generate a secure MongoDB keyfile for containerized environments on Mac and Linux. Lock it down right.","slug":"/CreateMongoSecurityKey","image":"https://jinnabalu.com/oio/img/mongo/CreateKeyfileForMongoSecurity.png","keywords":["mongodb","security","keyfile","container","docker","linux","mac","mongo auth","mongo security","enable auth"]},"sidebar":"tutorialSidebar","previous":{"title":"Mongo","permalink":"/oio/docs/category/mongo"},"next":{"title":"\u26a1 Run MongoDB Locally for Dev","permalink":"/oio/docs/RunMongoDBForDev"}}');var t=o(4848),r=o(8453);const a={sidebar_position:1,title:"\ud83d\udd10 Security Create Keyfile for MongoDB Security",description:"Quick and clear guide to generate a secure MongoDB keyfile for containerized environments on Mac and Linux. Lock it down right.",slug:"/CreateMongoSecurityKey",image:"https://jinnabalu.com/oio/img/mongo/CreateKeyfileForMongoSecurity.png",keywords:["mongodb","security","keyfile","container","docker","linux","mac","mongo auth","mongo security","enable auth"]},s="\ud83d\udd10 Enabling MongoDB Auth with a Keyfile",c={},l=[{value:"Why Keyfile",id:"why-keyfile",level:2},{value:"\ud83c\udf4f MacOS (Container Setup)",id:"-macos-container-setup",level:2},{value:"\ud83d\udc27 Linux (Container Setup)",id:"-linux-container-setup",level:2},{value:"\u2705 How to Use the Keyfile in Your MongoDB Container",id:"-how-to-use-the-keyfile-in-your-mongodb-container",level:2},{value:"\ud83d\udee1\ufe0f Pro Tips",id:"\ufe0f-pro-tips",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"-enabling-mongodb-auth-with-a-keyfile",children:"\ud83d\udd10 Enabling MongoDB Auth with a Keyfile"})}),"\n",(0,t.jsx)(n.h2,{id:"why-keyfile",children:"Why Keyfile"}),"\n",(0,t.jsx)(n.p,{children:"Used to enable internal authentication between MongoDB instances \u2014 especially in secure, multi-node setups."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Create security key for Mongo",src:o(9601).A+"",width:"1920",height:"1080"})}),"\n",(0,t.jsx)(n.h2,{id:"-macos-container-setup",children:"\ud83c\udf4f MacOS (Container Setup)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Create the keyfile\nopenssl rand -base64 741 >> mongoKeyFileMac\n\n# Lock it down\nchmod 600 mongoKeyFileMac\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-linux-container-setup",children:"\ud83d\udc27 Linux (Container Setup)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Generate the keyfile\nopenssl rand -base64 756 > mongoKeyFileLinux\n\n# Secure the file permissions\nchmod 600 mongoKeyFileLinux\n\n# Set the file ownership to match MongoDB container user\nsudo chown 999 mongoKeyFileLinux\nsudo chgrp 999 mongoKeyFileLinux\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-how-to-use-the-keyfile-in-your-mongodb-container",children:"\u2705 How to Use the Keyfile in Your MongoDB Container"}),"\n",(0,t.jsx)(n.p,{children:"After generating the keyfile, mount it into your container and point MongoDB to it using the --keyFile flag."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yml",children:'services:\n  mongodb:\n    image: mongo:6\n    volumes:\n      # \ud83d\udc47 Mount your generated keyfile here\n      # Use this line *only* if you\'re on a Linux host\n      - ../keyfile-linux/mongoKeyFileLinux:/opt/keyfile/mongoKeyFileLinux\n\n      # Use this line *only* if you\'re on a Mac host (Docker Desktop)\n      # - ../keyfile-mac/mongoKeyFileMac:/opt/keyfile/mongoKeyFileMac\n\n    command: ["mongod", "--replSet", "mongo-rs", "--bind_ip", "localhost,mongodb", "--keyFile", "/opt/keyfile/mongoKeyFileLinux"]\n\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\ufe0f-pro-tips",children:"\ud83d\udee1\ufe0f Pro Tips"}),"\n",(0,t.jsx)(n.p,{children:"Use the same filename inside the container as the one you reference in --keyFile."}),"\n",(0,t.jsx)(n.p,{children:"Make sure the file has chmod 600 and is owned by UID 999 (chown 999), especially on Linux."}),"\n",(0,t.jsx)(n.p,{children:"MongoDB will refuse to start if the keyfile permissions are too loose."})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>a,x:()=>s});var i=o(6540);const t={},r=i.createContext(t);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:n},e.children)}},9601:(e,n,o)=>{o.d(n,{A:()=>i});const i=o.p+"assets/images/CreateKeyfileForMongoSecurity-170f53ccf14af5866ae4f5538be474f9.png"}}]);